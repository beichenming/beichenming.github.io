---
layout: post
title: 北辰明的2016春季总结
subtitle:   "工作总结笔记"
date:       2016-06-09 13:31:00
author:     "BCM"
header-img: "../../img/post-bg-2015.jpg"
tags:
    - Job
    - Summary
---

**不知不觉又到端午节了，时间实在是过的太快了，起了一个大早去赶动车回家。昨天晚上终于把新版的iOS1.4.0正式提交到AppStore审核，所以有必要来第一季度总结一下最近在工作中遇到的问题，成长和感悟了。**

###### 第一个层面是关于一些代码层面的东西，就是我一直强调同时想遵守的事情：写优雅的代码

1. `第一就是Design Pattern`，这其实决定了你未来代码会走向什么风格以及日后新的功能模块添加进来的耦合度问题。这里我遇到的问题就是之前项目的中的消息通知机制都是采用ObServer Pattern来完成，更新信息的对象在每次更新完后post出一个消息，所有register了这个消息的地方都会收到更新通知，做之后对应的事件。出事的地方在于两个方面第一方面是项目中其实一直有一个消息控制中心，但是却只注册了一个消息，剩下所有的消息都是分散在代码中各个模块中没有统一起来，然后就出问题了，你会发现很多地方都是注册和接收消息，非常不利于日后维护，你都不知道项目中到底注册过多少消息转发过多少消息，以及部分独立模块模块间的刷新UI等操作没有按照消息机制完成，导致有部分的地方耦合非常严重。其实当我写到这里的时候突然又意识到之前有几个消息存在一些问题，并不是逻辑层面上的问题，我会在另一篇文章中详解。还有就是之前的我在前面的文章中提到的关于AOP编程的概念，对于日志以及用户行为的纪录分散到了各个业务逻辑里了，这样很显然是不对的。
	
2. `第二方面就是跟业务具体相关的代码`，举例来说，我们有很多关于网络的request的请求，每一个request请求在上层都有一个对应的task负责来启动它的执行，处理callback，保存到本地数据库等等操作，多个task在相同业务模块下会有一个公共的manager来控制task的启动以及callback，消息通知等等的纯业务的处理。理论上我们是不允许自己手动创建task去start处理事件的，所有的task只能通过对应的manager负责start和管理。但是现在的代码中还是有不少地方跳过了manager直接通过task来进行处理（其实我自己也写过，后来才意识到问题），这也是要改善的地方。还有再举个例子，是关于字符串的，我们的业务逻辑中存在4种purpose type，每种purpose type下面又有5种status type，所以就有20种组合，每种组合出来的type都会对应一个string，而且未来type的数量可能会越来越多，所以这个如果用switch，if等来操作判断对应的字符串显然是不合理的，太冗余不利于扩展，采用数据字典的方式也不太好还需要自己手动建，每次更新也要手动修改，最好的方式是我们可以直接通过两个type就组合出对应的string，所以这里我们采用枚举反射，OC没有枚举反射的现成实现，我们只能通过C++的方式通过字符串解析来完成，虽然很麻烦，但是痛苦一次以后就再也不用处理这件事了，一劳永逸。

3. `第三方面是关于重构`，我现在对于自己的要求是，空闲的时间，如果你发现一些觉得不合理的代码，那么我就会去改，改成合理的实现，尽管未来回过头再来看可能当时写的代码或多或少还是存在些问题，但是代码应该就是这样不断改进过来才会越来越好；如果比较忙，那么对于那些如果能在1-2小时就可以改掉的东西，那也要改，千万不要对自己说来不及了放在下个版本版，相信我，下个版本你依然不会去改的，因为下个版本会有下版本的事，你不会有时间。我觉得专门bugfix的版本是最适合去干重构这件事的。

###### 第二个层面就是关于工作中遇到的一些想法
1. 从1.2.4～1.4.0中间迭代了不少的版本了，我感觉自己写的每个版本自己都有在进步，不管是编码能力，还是对一些问题的思考，1.2.4这个版本回头是我最不满意的版本，
出于一些历史原因，当我接手的时候，由于周期短只有一个星期，当时对于这个项目的代码还不是很熟没有深入理解过，而且当时那个模块的界面基本已经构建好了，总结来说我当时没有把业务逻辑写好，虽然功能实现了，但是回过头来再看只能用惨不忍睹来形容了，代码的耦合度太高了，以至于我无法把该模块里的一些子模块抽象出来在其他模块中进行调用，不过值得庆幸的是，接下来的一个版本我们要对这个模块进行重新的设计，这样就让我有时间重新开发这个模块，而不用自己挤出时间进行这项工作了。这里非常感谢我的leader，他每次都会仔细code review我的代码，指出我一些我的问题，我也会把我的一些设计想法告诉他，问他是否合理，从而再进行优化。

2. 还有项目中总会遇到一些新的东西，需要边写边研究，可能最后走的方向并不能很好的解决自己的问题，我在1.4.0中就遇到了这个问题。其中有一个功能，我以为可以按自己的方案来完成，但是最后实在实现不了某一种场景下的问题。最后总结是自己和其他同事的交流不过深入，其实用另一种方法就可以很完美的解决我的问题，而且代码量也很少，但是就是我和他们缺少了一个功能的交流导致我多花了两天的时间做这件事，经过这件事我明白到工作中多交流绝对可以避免自己走很多弯路，还有一点虽然不想承认，其实是我在开发的过程中已经意识到自己的方案到最后可能行不通，但是我还是继续写下去了，我妄图用一些复杂的手段来解决这个问题，但是事实上即使我最后完成了，代价也会是巨大的。这里引用一句开玩笑的话，世上无难事，只要肯放弃（哈哈），我觉的项目中永远应该用最简单的方式现在最理想的效果，实在没有办法的时候才去想那些复杂的手段。在业余的时候去研究那些复杂的方案确实是值得实践的，因为可以学到很多东西。因为开发都是提倡又快又好的标准，我保证下次再也不犯这种错误了。

**leader有一句话说的很好：如果能做一件90分的事，就不要去做两件60分的事，是啊，一件90分的事说明你已经也来越趋向于满分了，你每次都是用心去做的，如果能从60分每次都进步最后到90分甚至100分，那也是不错的选择，至少自己在不断进步，养成一个不断思考问题的习惯，尽自己最大的努力去做一件事，把它做好，
每天都能学到东西是件很舒服的事，北辰明继续加油...**